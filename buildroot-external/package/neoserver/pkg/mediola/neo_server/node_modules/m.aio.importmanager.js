var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(f,a,b){f instanceof String&&(f=String(f));for(var d=f.length,c=0;c<d;c++){var e=f[c];if(a.call(b,e,c,f))return{i:c,v:e}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(f,a,b){if(f==Array.prototype||f==Object.prototype)return f;f[a]=b.value;return f};$jscomp.getGlobal=function(f){f=["object"==typeof globalThis&&globalThis,f,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var a=0;a<f.length;++a){var b=f[a];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(f,a){var b=$jscomp.propertyToPolyfillSymbol[a];if(null==b)return f[a];b=f[b];return void 0!==b?b:f[a]};
$jscomp.polyfill=function(f,a,b,d){a&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(f,a,b,d):$jscomp.polyfillUnisolated(f,a,b,d))};$jscomp.polyfillUnisolated=function(f,a,b,d){b=$jscomp.global;f=f.split(".");for(d=0;d<f.length-1;d++){var c=f[d];if(!(c in b))return;b=b[c]}f=f[f.length-1];d=b[f];a=a(d);a!=d&&null!=a&&$jscomp.defineProperty(b,f,{configurable:!0,writable:!0,value:a})};
$jscomp.polyfillIsolated=function(f,a,b,d){var c=f.split(".");f=1===c.length;d=c[0];d=!f&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var e=0;e<c.length-1;e++){var h=c[e];if(!(h in d))return;d=d[h]}c=c[c.length-1];b=$jscomp.IS_SYMBOL_NATIVE&&"es6"===b?d[c]:null;a=a(b);null!=a&&(f?$jscomp.defineProperty($jscomp.polyfills,c,{configurable:!0,writable:!0,value:a}):a!==b&&(void 0===$jscomp.propertyToPolyfillSymbol[c]&&(b=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[c]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(c):$jscomp.POLYFILL_PREFIX+b+"$"+c),$jscomp.defineProperty(d,$jscomp.propertyToPolyfillSymbol[c],{configurable:!0,writable:!0,value:a})))};$jscomp.polyfill("Array.prototype.find",function(f){return f?f:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");var m=m||{};m.aio=m.aio||{};m.aio.importmanager=m.aio.importmanager||{};
m.aio.importmanager.Manager=function(){var f=function(a){this._appname=a;this._appname||(this._appname="iqontrolpro")};f.prototype.setAppName=function(a){this._appname=a};f.prototype.importSteckerPRO=function(a,b,d,c){var e=function(g,l){var k={rooms:[],devices:[],gateways:[]};try{var n,r,t=$($.parseXML(l)),u=t.find("gateway");if(u&&0<u.length)for(n=0;n<u.length;n++){var x=u[n];if(x){var y=$(x).find("transmitter");if(y&&0<y.length&&y[0]){var J=$(y[0]),C=J.attr("ip"),D=J.attr("mode");C&&D&&(D=parseInt(D),
k.gateways.push({index:k.gateways.length+1,name:("hc"==g?"HC":g)+" Gateway",info:{sys:"hcgw",ip:C,port:49880,vendor:g,mode:1==D?1:0}}))}}}0==k.gateways.length&&k.gateways.push({index:k.gateways.length+1,name:("hc"==g?"HC":g)+" Gateway",info:{sys:"hcgw",ip:"0.0.0.0",port:49880,vendor:g,mode:1}});var E=t.find("location");if(E&&0<E.length)for(n=0;n<E.length;n++){var K=E[n];if(K){var A=$(K);if(r=A.attr("id")){var F={index:k.rooms.length+1,name:r};k.rooms.push(F);var B=A.find("device");if(B&&0<B.length)for(g=
0;g<B.length;g++){var L=B[g];if(L){var G=$(L);r=G.attr("id");var H=G.attr("type"),I=G.attr("address"),w=G.attr("data");if(r&&H&&I&&w){switch(H){case "BS":var z="brennenstuhl";var v="RC 3600";"heater"==w&&(v="FHT 433");break;case "ELRO":z="brennenstuhl";v="RCS 1000N";break;case "DY":z="rohrmotor24";v="RMF Motor";break;case "DY2":z="rohrmotor24";v="RMF-RS1 (AP/UP)";break;case "IT":z="intertechno",9<=I.length?(v="IT-1500 ","shutter"==w?v="ITL-1000":"dimmer"==w&&(v="ITLR-300")):(v="CMR-300","shutter"==
w&&(v="CMR-500"))}k.devices.push({index:k.devices.length+1,name:r,room:F.index,info:{sys:"hcgw",gateway:1,data:w,type:"IT"==H&&9<=I.length?"IT2":H,manufacture:z,model:v,address:I}})}}}}}}}catch(M){console.error(M)}return k},h=function(g,l){var k={groups:[]};try{var n,r=$($.parseXML(g)).find("location");if(r&&0<r.length)for(n=0;n<r.length;n++){var t=r[n];if(t){var u=$(t),x=u.attr("id"),y;if(y=x)a:{for(g=0;g<l.length;g++)if(l[g]===x){y=!0;break a}y=!1}if(y){var J={classid:"group",index:k.groups.length+
1,name:x,macros:[]};k.groups.push(J);var C=u.find("macro");if(C&&0<C.length)for(g=0;g<C.length;g++){var D=C[g];if(D){var E=$(D),K=E.attr("id");if(K){var A={classid:"macro",index:J.macros.length+1,name:K,commands:[]};J.macros.push(A);var F=E.find("command");if(F&&0<F.length)for(var B=0;B<F.length;B++){var L=F[B];if(L){var G=$(L),H=G.attr("action"),I=G.attr("sleep");if(H){var w=H.split(".");if(3==w.length){var z={classid:"command",index:A.commands.length+1,action:{type:"command",device:{name:w[1],room:w[0]},
value:w[2]}};A.commands.push(z)}}else I&&(z={classid:"sleep",index:A.commands.length+1,time:parseInt(I)},A.commands.push(z))}}}}}}}}}catch(v){console.error(v)}return k},q=require("m.aio.configmanager.js"),p=q.LicenseManager;q.trace("/config/tenants/"+a,function(g,l){if(g)c&&c(g);else if(l&&l.license){if(p.permitFeature("read",{sys:"hcgw",ip:"127.0.0.1",vendor:"brennenstuhl"},l.license))g="brennenstuhl";else if(p.permitFeature("read",{sys:"hcgw",ip:"127.0.0.1",vendor:"intertechno"},l.license))g="intertechno";
else if(p.permitFeature("read",{sys:"hcgw",ip:"127.0.0.1",vendor:"hc"},l.license))g="hc";else{c&&c(Error("license do not have hcgw module"));return}g=e(g,b);var k=[];g&&g.rooms&&g.rooms.forEach(function(u){u&&u.name&&k.push(u.name)});var n=h(d,k);l=require("m.aio.devicemanager.js");var r=require("m.aio.macromanager.js");if(l=l.getIntHandler(a)){var t=r._getHandler(a);t?(l.data=g,l._save(function(u){u?c&&c(u):(t.macros=r.Macros.parse(n),t._saveMacros(function(x){c&&c(x)}))})):c&&c(Error("no such tenant for macros"))}else c&&
c(Error("no such tenant"))}else c&&c("invalid tenant")})};f.prototype.getConfigList_IQP=function(a,b,d,c){a+="/iqconfig/getconfigs";var e=require("url").parse(a);a=e.protocol;"http:"==a&&(a="http");"https:"==a&&(a="https");a||(a="https");var h=e.port;h||(h=443);b={host:e.hostname,port:h,path:e.path+"?app="+this._appname,auth:b+":"+d};b=require(a).request(b,function(q){q.setEncoding("utf8");var p="";q.on("data",function(g){p+=g});q.on("end",function(){if(200!=q.statusCode)c&&(c(Error("http reponse code:"+
q.statusCode)),c=null);else try{var g=[];p&&(g=JSON.parse(p));c&&(c(null,g),c=null)}catch(l){c&&(c(Error("invalid json reponse")),c=null)}})});b.on("timeout",function(){c&&(c(Error("http timeout")),c=null)});b.on("error",function(q){c&&(c(q),c=null)});b.end()};f.prototype.downloadConfig_IQP=function(a,b,d,c,e){a+="/iqconfig/getdevices";var h=require("url").parse(a);a=h.protocol;"http:"==a&&(a="http");"https:"==a&&(a="https");a||(a="https");var q=h.port;q||(q=443);b={host:h.hostname,port:q,path:h.path+
"?app="+this._appname+"&name="+encodeURIComponent(c),auth:b+":"+d};b=require(a).request(b,function(p){p.setEncoding("utf8");var g="";p.on("data",function(l){g+=l});p.on("end",function(){200!=p.statusCode?e&&(e(Error("http reponse code:"+p.statusCode)),e=null):e&&(e(null,g),e=null)})});b.on("timeout",function(){e&&(e(Error("http timeout")),e=null)});b.on("error",function(p){e&&(e(p),e=null)});b.end()};f.prototype.decryptConfig_IQP=function(a,b,d){a=require("x.crypt.js").AES.decodeString(a,b);if("string"==
typeof a&&0<a.length){b=null;try{b=JSON.parse(a),d&&d(null,b)}catch(c){d&&d(Error("invalid config json"))}}else d&&d(Error("decryption failed"))};f.prototype.importConfig_IQP=function(a,b,d,c,e){require("m.aio.configmanager.js").trace("/config/tenants/"+a,function(h,q){if(h)e&&e(h);else if(q&&q.license){h=b;b.system&&(h=b.system);var p=require("m.aio.devicemanager.js"),g=p.getIntHandler(a);if(g){var l=-1,k=[];if(h.rooms)for(var n=0;n<h.rooms.length;n++){var r=h.rooms[n];if(r)if("_cameras_288c9304ed854ca5f41185e88b240621"==
r.name){l=r.index;break}else k.push(r.index)}else h.rooms=[];if(-1==l){for(l=1;-1!=k.indexOf(l);)l++;h.rooms.push({name:"_cameras_288c9304ed854ca5f41185e88b240621",index:l})}if(h.devices)for(k=0;k<h.devices.length;k++)(n=h.devices[k])&&n.info&&("cloudservice"==n.info.sys&&"ivideon"==n.info.module&&"camera"==n.info.type?n.room=l:"cam"==n.info.sys&&(n.room=l));else h.devices=[];if(h.gateways)for(l=0;l<h.gateways.length;l++)(k=h.gateways[l])&&k.info&&("cloudservice"==k.info.sys&&(k.info.ip||(k.info.ip=
"cloud.mediola.com"),k.info.port||(k.info.port=443),k.info.username||k.info.password||(k.info.username=d,k.info.password=c)),"aio"==k.info.sys&&"gtw"==k.info.common_type&&(h.gateways.splice(l,1),l--));else h.gateways=[];g.data=h;g._save(function(t){t?e&&e(t):p.reloadTenant(q,function(u){e&&e(u)})})}else e&&e(Error("no such tenant"))}else e&&e("invalid tenant")})};f.prototype.downloadMacros_IQP=function(a,b,d,c,e){a+="/iqconfig/getmacros";var h=require("url").parse(a);a=h.protocol;"http:"==a&&(a="http");
"https:"==a&&(a="https");a||(a="https");var q=h.port;q||(q=443);b={host:h.hostname,port:q,path:h.path+"?app="+this._appname+"&name="+encodeURIComponent(c),auth:b+":"+d};b=require(a).request(b,function(p){p.setEncoding("utf8");var g="";p.on("data",function(l){g+=l});p.on("end",function(){200!=p.statusCode?e&&(e(Error("http reponse code:"+p.statusCode)),e=null):e&&(e(null,g),e=null)})});b.on("timeout",function(){e&&(e(Error("http timeout")),e=null)});b.on("error",function(p){e&&(e(p),e=null)});b.end()};
f.prototype.decryptMacros_IQP=function(a,b,d){a=require("x.crypt.js").AES.decodeString(a,b);if(0<a.length&&"string"==typeof a){b=null;try{b=JSON.parse(a),d&&d(null,b)}catch(c){d&&d(Error("invalid macros json"))}}else d&&d(Error("decryption failed"))};f.prototype.importMacros_IQP=function(a,b,d){require("m.aio.configmanager.js").trace("/config/tenants/"+a,function(c,e){if(c)d&&d(c);else if(e&&e.license){c=require("m.aio.macromanager.js");var h=c._getHandler(a);if(h){var q=require("m.aio.devicemanager.js").getIntHandler(a);
if(q){if(b&&b.groups)for(var p=0;p<b.groups.length;p++){var g=b.groups[p];if(g&&g.macros)for(var l=0;l<g.macros.length;l++){var k=g.macros[l];if(k&&k.commands)for(var n=0;n<k.commands.length;n++){var r=k.commands[n];if(r&&r.action&&r.action.device){var t=r.action.device.room;t&&!isNaN(parseInt(t))&&(t=q.findRoomWithIndex(parseInt(t)))&&t.name&&(r.action.device.room=t.name)}}}}h.macros=c.Macros.parse(b);h._saveMacros(function(u){u?d&&d(u):require("m.aio.devicemanager.js").reloadTenant(e,function(x){d&&
d(x)})})}else d&&d(Error("no device manager"))}else d&&d(Error("no such tenant"))}else d&&d("invalid tenant")})};return f}();m.aio.importmanager.Handler=m.aio.importmanager.Manager;"undefined"!=typeof module&&null!=module&&(module.exports=new m.aio.importmanager.Handler);
