var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.checkStringArgs=function(f,a,b){if(null==f)throw new TypeError("The 'this' value for String.prototype."+b+" must not be null or undefined");if(a instanceof RegExp)throw new TypeError("First argument to String.prototype."+b+" must not be a regular expression");return f+""};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;
$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(f,a,b){if(f==Array.prototype||f==Object.prototype)return f;f[a]=b.value;return f};
$jscomp.getGlobal=function(f){f=["object"==typeof globalThis&&globalThis,f,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var a=0;a<f.length;++a){var b=f[a];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};
$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(f,a){var b=$jscomp.propertyToPolyfillSymbol[a];if(null==b)return f[a];b=f[b];return void 0!==b?b:f[a]};$jscomp.polyfill=function(f,a,b,c){a&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(f,a,b,c):$jscomp.polyfillUnisolated(f,a,b,c))};
$jscomp.polyfillUnisolated=function(f,a,b,c){b=$jscomp.global;f=f.split(".");for(c=0;c<f.length-1;c++){var d=f[c];if(!(d in b))return;b=b[d]}f=f[f.length-1];c=b[f];a=a(c);a!=c&&null!=a&&$jscomp.defineProperty(b,f,{configurable:!0,writable:!0,value:a})};
$jscomp.polyfillIsolated=function(f,a,b,c){var d=f.split(".");f=1===d.length;c=d[0];c=!f&&c in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var e=0;e<d.length-1;e++){var g=d[e];if(!(g in c))return;c=c[g]}d=d[d.length-1];b=$jscomp.IS_SYMBOL_NATIVE&&"es6"===b?c[d]:null;a=a(b);null!=a&&(f?$jscomp.defineProperty($jscomp.polyfills,d,{configurable:!0,writable:!0,value:a}):a!==b&&(void 0===$jscomp.propertyToPolyfillSymbol[d]&&(b=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[d]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(d):$jscomp.POLYFILL_PREFIX+b+"$"+d),$jscomp.defineProperty(c,$jscomp.propertyToPolyfillSymbol[d],{configurable:!0,writable:!0,value:a})))};$jscomp.polyfill("String.prototype.repeat",function(f){return f?f:function(a){var b=$jscomp.checkStringArgs(this,null,"repeat");if(0>a||1342177279<a)throw new RangeError("Invalid count value");a|=0;for(var c="";a;)if(a&1&&(c+=b),a>>>=1)b+=b;return c}},"es6","es3");
$jscomp.findInternal=function(f,a,b){f instanceof String&&(f=String(f));for(var c=f.length,d=0;d<c;d++){var e=f[d];if(a.call(b,e,d,f))return{i:d,v:e}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(f){return f?f:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");var xnm=xnm||{};xnm.aio=xnm.aio||{};xnm.aio.raumfeld=xnm.aio.raumfeld||{};
xnm.aio.raumfeld.Player=function(){var f=function(){this._renderer=null};f.prototype.getIP=function(){return this._renderer?this._renderer.ip:null};f.prototype.setIP=function(a){this._renderer&&(this._renderer.ip=a)};f.prototype.getPort=function(){return this._renderer?this._renderer.port:null};f.prototype.setPort=function(a){this._renderer&&(this._renderer.port=a)};f.prototype.getUUID=function(){return this._renderer?this._renderer.uuid:null};f.prototype.executeCommandCreator=function(a,b,c){b&&
b.value?this._executeCommand(b.value,b.ext,function(d){c&&c(d)}):c&&c(Error("command value is empty"))};f.prototype.getStatesCreator=function(a,b,c){this._getStates(function(d,e){if(d)c&&c(d);else{d=[];for(var g=0;g<b.length;g++){var h=b[g];if(h&&h.id&&h.status)switch(h.status.value){case "muted":null!=e.muted&&"undefined"!=typeof e.muted&&d.push({id:h.id,status:e.muted});break;case "volume":null!=e.volume&&"undefined"!=typeof e.volume&&d.push({id:h.id,status:e.volume});break;case "playMode":e.playMode&&
d.push({id:h.id,status:e.playMode});break;case "playState":e.transportState&&d.push({id:h.id,status:e.transportState});break;case "duration":e.playInfo&&e.playInfo.duration&&d.push({id:h.id,status:e.playInfo.duration});break;case "durationS":e.playInfo&&"undefined"!=typeof e.playInfo.durationSec&&null!=e.playInfo.durationSec&&d.push({id:h.id,status:e.playInfo.durationSec});break;case "position":e.playInfo&&e.playInfo.position&&d.push({id:h.id,status:e.playInfo.position});break;case "positionS":e.playInfo&&
"undefined"!=typeof e.playInfo.positionSec&&null!=e.playInfo.positionSec&&d.push({id:h.id,status:e.playInfo.positionSec});break;case "artist":e.playInfo&&e.playInfo.trackMetaData&&e.playInfo.trackMetaData.artist?d.push({id:h.id,status:e.playInfo.trackMetaData.artist}):d.push({id:h.id,status:""});break;case "title":e.playInfo&&e.playInfo.trackMetaData&&e.playInfo.trackMetaData.title?d.push({id:h.id,status:e.playInfo.trackMetaData.title}):d.push({id:h.id,status:""});break;case "album":e.playInfo&&e.playInfo.trackMetaData&&
e.playInfo.trackMetaData.album?d.push({id:h.id,status:e.playInfo.trackMetaData.album}):d.push({id:h.id,status:""});break;case "eqLow":e.eq&&"undefined"!=typeof e.eq.eqLow&&null!=e.eq.eqLow&&d.push({id:h.id,status:parseFloat(e.eq.eqLow)});break;case "eqMid":e.eq&&"undefined"!=typeof e.eq.eqMid&&null!=e.eq.eqMid&&d.push({id:h.id,status:parseFloat(e.eq.eqMid)});break;case "eqHigh":e.eq&&"undefined"!=typeof e.eq.eqHigh&&null!=e.eq.eqHigh&&d.push({id:h.id,status:parseFloat(e.eq.eqHigh)});break;case "shuffle":e.playMode&&
e.playMode.shuffle&&d.push({id:h.id,status:e.playMode.shuffle});break;case "repeat":e.playMode&&e.playMode.repeat&&d.push({id:h.id,status:e.playMode.repeat})}}c&&c(null,d)}})};f.prototype.play=function(a,b,c){if(a&&b&&b["class"]&&b.id){var d=this;a.browseMetaData(b.id,function(e,g){if(e)c&&c(e);else if(0!=b["class"].indexOf("object.container")||b.res&&b.res.url){if(b.res&&b.res.url)e=b.res.url;else{if(!g||!g.meta||!g.meta.res){c&&c(Error("resource url invalid"));return}e=g.meta.res}d._renderer.playResource({url:e},
g.result,c)}else a.uuid?d._renderer.playContainer({containerID:b.id,server_uuid:a.uuid},g.result,c):c&&c(Error("media server uuid invalid"))})}else c&&c(Error("play obj invalid"))};f.prototype.playFromContainer=function(a,b,c,d){if(a&&b&&b.id&&b.parentID)if(a.uuid){var e=this;a.browseMetaData(b.parentID,function(g,h){g?d&&d(g):e._renderer.playContainer({containerID:b.parentID,server_uuid:a.uuid,firstIdx:c},h.result,d)})}else d&&d(Error("media server uuid invalid"));else d&&d(Error("play obj invalid"))};
f.prototype.browser=function(a,b,c,d,e){a?(b||(b=0),c||(c=0),d||(d=0),a.browseChildren(b,c,d,null,function(g,h,l){e&&e(g,h,l)})):e&&e(Error("play obj invalid"))};f.prototype._executeCommand=function(a,b,c){if(this._renderer)switch(a){case "play":this._renderer.play(c);break;case "pause":this._renderer.pause(c);break;case "stop":this._renderer.stop(c);break;case "previous":this._renderer.previous(c);break;case "next":this._renderer.next(c);break;case "mute":this._renderer.mute(function(d){setTimeout(function(){c&&
c(d)},500)});break;case "unmute":this._renderer.unmute(function(d){setTimeout(function(){c&&c(d)},500)});break;case "toggleMute":this._renderer.toggleMute(function(d){setTimeout(function(){c&&c(d)},500)});break;case "volumeUp":this._renderer.volumeUp(c);break;case "volumeDown":this._renderer.volumeDown(c);break;case "setPlayMode":if(!b){c&&c(Error("play mode value invalid"));break}this._renderer.setPlayMode(b,c);break;case "seekTo":if("undefined"==typeof b||null==b){c&&c(Error("seek value invalid"));
break}this._renderer.seekRelTimeSec(b,c);break;case "setVolume":if("undefined"==typeof b||null==b){c&&c(Error("volume value invalid"));break}this._renderer.setVolume(b,c);break;case "shuffleToggle":this.shuffleToggle(c);break;case "repeatSwitch":this.repeatSwitch(c);break;default:c&&c(Error("unknown command"))}else c&&c(Error("renderer not initialized"))};f.prototype._getStates=function(a){if(this._renderer){var b=function(){d--;0==d&&a&&a(null,c)},c={},d=5;this._renderer.getPlayState(function(e,
g){e||(c.transportState=g);b()});this._renderer.getPlayInfo(function(e,g){e||(c.playInfo=g);b()});this._renderer.isMuted(function(e,g){e||(c.muted=g);b()});this._renderer.getVolume(function(e,g){e||(c.volume=g);b()});this.getPlayMode(function(e,g){e||(c.playMode=g);b()})}else a&&a(Error("renderer not initialized"))};f.prototype.getPlayMode=function(a){if(this._renderer){var b=this;this._renderer.getPlayMode(function(c,d){c?a&&a(c):a&&a(null,b._parsePlayMode(d))})}else a&&a(Error("renderer not initialized"))};
f.prototype.setPlayMode=function(a,b){this._renderer?(a=this._buildPlayMode(a),this._renderer.setPlayMode(a,b)):b&&b(Error("renderer not initialized"))};f.prototype._parsePlayMode=function(a){switch(a){case "NORMAL":return{shuffle:"off",repeat:"off"};case "REPEAT_ALL":return{shuffle:"off",repeat:"all"};case "REPEAT_ONE":return{shuffle:"off",repeat:"one"};case "RANDOM":return{shuffle:"on",repeat:"all"};case "SHUFFLE":return{shuffle:"on",repeat:"off"};default:return{shuffle:"off",repeat:"off"}}};f.prototype._buildPlayMode=
function(a){var b=a.shuffle;a=a.repeat;b||(b="off");a||(a="off");return"off"==b&&"off"==a?"NORMAL":"off"==b&&"all"==a?"REPEAT_ALL":"off"==b&&"one"==a?"REPEAT_ONE":"on"==b&&"off"==a?"SHUFFLE":"on"==b&&"all"==a?"RANDOM":"NORMAL"};f.prototype.shuffleToggle=function(a){if(this._renderer){var b=this;this.getPlayMode(function(c,d){c?a&&a(c):(d.shuffle="on"==d.shuffle?"off":"on",b.setPlayMode(d,a))})}else a&&a(Error("renderer not initialized"))};f.prototype.repeatSwitch=function(a){if(this._renderer){var b=
this;this.getPlayMode(function(c,d){c?a&&a(c):(d.repeat="off"==d.shuffle?"off"==d.repeat?"all":"all"==d.repeat?"one":"off":"off"==d.repeat?"all":"off",b.setPlayMode(d,a))})}else a&&a(Error("renderer not initialized"))};f.prototype.equalsTo=function(a){return a&&a instanceof f?this.getIP()==a.getIP()&&this.getPort()==a.getPort():!1};return f}();
xnm.aio.raumfeld.MasterPlayer=function(){var f=function(a,b,c){this._logger="undefined"!=typeof require&&require?require("x.logger.js").getLogger("xnm.aio.raumfeld.MasterDevice"):{log:{}};this.ip=a;this.port=b;this.port||(this.port=47365);this.uuid=c;this._zonePlayer=this._zones=null;this._getInfoCbs=[];this._autoGetInfoTimeout=null};f.prototype.getIP=function(){return this.ip};f.prototype.getPort=function(){return this.port};f.prototype.getUUID=function(){return this.uuid};f.prototype.executeCommandCreator=
function(a,b,c){if(this._zonePlayer)this._zonePlayer.executeCommandCreator(a,b,c);else{var d=this;this.getInfos(function(e){e?c&&c(e):d._zonePlayer?d._zonePlayer.executeCommandCreator(a,b,c):c&&c(e)})}};f.prototype.getStatesCreator=function(a,b,c){if(this._zonePlayer)this._zonePlayer.getStatesCreator(a,b,c);else{var d=this;this.getInfos(function(e){e?c&&c(e):d._zonePlayer?d._zonePlayer.getStatesCreator(a,b,c):c&&c(e)})}};f.prototype.play=function(a,b,c){if(this._zonePlayer)this._zonePlayer.play(a,
b,c);else{var d=this;this.getInfos(function(e){e?c&&c(e):d._zonePlayer?d._zonePlayer.play(a,b,c):c&&c(e)})}};f.prototype.playFromContainer=function(a,b,c,d){if(this._zonePlayer)this._zonePlayer.playFromContainer(a,b,c,d);else{var e=this;this.getInfos(function(g){g?d&&d(g):e._zonePlayer?e._zonePlayer.playFromContainer(a,b,c,d):d&&d(g)})}};f.prototype.browser=function(a,b,c,d,e){if(this._zonePlayer)this._zonePlayer.browser(a,b,c,d,e);else{var g=this;this.getInfos(function(h){h?e&&e(h):g._zonePlayer?
g._zonePlayer.browser(a,b,c,d,e):e&&e(h)})}};f.prototype.getAllRoomInfo=function(a){if(this._zones){var b=[],c;for(c in this._zones.roomPlayers){var d=this._zones.roomPlayers[c];d&&b.push({uuid:d.getUUID(),name:d.getRoomName()})}a&&a(null,b)}else{var e=this;this.getInfos(function(g){g?a&&a(g):e._zones?e.getAllRoomInfo(a):a&&a(g)})}};f.prototype.getAllZoneInfo=function(a){if(this._zones){var b=[],c;for(c in this._zones.zonePlayers){var d=this._zones.zonePlayers[c];d&&b.push({uuid:d.getUUID(),rooms:d.getRooms()})}a&&
a(null,b)}else{var e=this;this.getInfos(function(g){g?a&&a(g):e.getAllZoneInfo(a)})}};f.prototype.getCurrentZone=function(a){if(this._zonePlayer)a&&a(null,this._zonePlayer);else{var b=this;this.getInfos(function(c){c?a&&a(c):this._zonePlayer?b.getCurrentZone(a):a&&a(Error("no current zone"))})}};f.prototype.setCurrentZone=function(a,b){if(a)if(this._zones){var c=this._zones.zonePlayers[a],d=null;c||(d=Error("no such zone"));b&&b(d,c)}else{var e=this;this.getInfos(function(g){g?b&&b(g):e.setCurrentZone(a,
b)})}else b&&b(Error("zone uuid invalid"))};f.prototype.addRoomToZone=function(a,b,c){var d="/"+this.uuid+"/connectRoomToZone?";d+="zoneUDN="+encodeURIComponent("uuid:"+b);d+="&roomUDN="+encodeURIComponent("uuid:"+a);var e=this;this._doGetRequest(this.ip,47365,d,function(g){g?c&&c(g):e.getInfos(c)})};f.prototype.dropRoom=function(a,b){var c="/"+this.uuid+"/dropRoomJob?";c+="roomUDN="+encodeURIComponent("uuid:"+a);var d=this;this._doGetRequest(this.ip,47365,c,function(e){e?b&&b(e):d.getInfos(b)})};
f.prototype.getRoomPlayer=function(a){if(!a||!a.uuid)return null;this._zones||(this._zones={zonePlayers:{},roomPlayers:{},dedicatePlayers:{}});var b=this._zones.roomPlayers[a.uuid];if(b)return b;if(!a.port||!a.port||!a.zone_uuid)return null;b=new xnm.aio.raumfeld.RoomPlayer(a.ip,a.port,a.zone_uuid,a.uuid);b._isDummy=!0;return this._zones.roomPlayers[a.uuid]=b};f.prototype.getDiscoveredRoomPlayer=function(a){if(!a)return null;this._zones||(this._zones={zonePlayers:{},roomPlayers:{},dedicatePlayers:{}});
a=this._zones.roomPlayers[a];return!a||a._isDummy?null:a};f.prototype.getRoomPlayers=function(){if(!this._zones)return null;var a=[],b;for(b in this._zones.roomPlayers)a.push(this._zones.roomPlayers[b]);return a};f.prototype.getDedicatePlayer=function(a){if(!a||!a.uuid)return null;this._zones||(this._zones={zonePlayers:{},roomPlayers:{},dedicatePlayers:{}});var b=this._zones.dedicatePlayers[a.uuid];if(b)return b;if(!a.port||!a.port)return null;b=new xnm.aio.raumfeld.DedicatePlayer(a.ip,a.port,a.uuid);
b._isDummy=!0;return this._zones.dedicatePlayers[a.uuid]=b};f.prototype.getDiscoveredDedicatePlayer=function(a){if(!a)return null;this._zones||(this._zones={zonePlayers:{},roomPlayers:{},dedicatePlayers:{}});a=this._zones.dedicatePlayers[a];return!a||a._isDummy?null:a};f.prototype.getDedicatePlayers=function(a){if(!this._zones)return null;var b=[];for(a in this._zones.dedicatePlayers)b.push(this._zones.dedicatePlayers[a]);return b};f.prototype.getInfos=function(a){var b=this._getInfoCbs.length;a&&
-1==this._getInfoCbs.indexOf(a)&&this._getInfoCbs.push(a);if(0==b){this._autoGetInfoTimeout&&(clearTimeout(this._autoGetInfoTimeout),this._autoGetInfoTimeout=null);var c=this;this._getInfos(function(d,e,g){c._autoGetInfoTimeout=setTimeout(function(){c.getInfos(null)},5E3);var h=c._getInfoCbs;c._getInfoCbs=[];h.forEach(function(l){l&&l(d,e,g)})})}};f.prototype._getInfos=function(a){var b=this;this._listDevices(function(c,d){c?a&&a(c):b._getZones(function(e,g){e?a&&a(e):(b._updateBufferedZones(g,d),
a&&a(null,g,d))})})};f.prototype._getZones=function(a){this._doGetRequest(this.ip,47365,"/"+this.uuid+"/getZones",function(b,c){if(b)a&&a(b);else try{var d={},e=$($.parseXML(c));e.find("zone").each(function(){var g=$(this),h=g.attr("udn");h&&(d[h]={},g.find("room").each(function(){var l=$(this),m=l.attr("udn"),k=l.attr("name");m&&k&&(d[h][m]={name:k,renderer:{}},l.find("renderer").each(function(){var q=$(this),p=q.attr("udn");q=q.attr("name");p&&q&&(d[h][m].renderer[p]=q)}))}))});e.find("unassignedRooms").each(function(){var g=
$(this);d.idle={};g.find("room").each(function(){var h=$(this),l=h.attr("udn"),m=h.attr("name");l&&m&&(d.idle[l]={name:m,renderer:{}},h.find("renderer").each(function(){var k=$(this),q=k.attr("udn");k=k.attr("name");q&&k&&(d.idle[l].renderer[q]=k)}))})});a&&a(null,d)}catch(g){a&&a(g)}})};f.prototype._listDevices=function(a){this._doGetRequest(this.ip,47365,"/"+this.uuid+"/listDevices",function(b,c){if(b)a&&a(b);else try{var d={};$($.parseXML(c)).find("device").each(function(){var e=$(this),g=e.attr("udn");
g&&(d[g]={udn:g,type:e.attr("type"),location:e.attr("location"),name:e.text()},e=require("url").parse(e.attr("location")),d[g].ip=e.hostname,d[g].port=e.port)});a&&a(null,d)}catch(e){a&&a(e)}})};f.prototype._updateBufferedZones=function(a,b){var c=[],d=[],e=[];this._zones||(this._zones={zonePlayers:{},roomPlayers:{},dedicatePlayers:{}});for(var g in a){c.push(g);var h=a[g];if("idle"!=g){var l=g.substr(5),m=b[g];if(m)if(this._zones.zonePlayers[l]){var k=this._zones.zonePlayers[l];k.setIP(m.ip);k.setPort(m.port)}else k=
new xnm.aio.raumfeld.ZonePlayer(m.ip,m.port,l),this._zones.zonePlayers[l]=k}k&&k.clearRoom();for(var q in h){d.push(q);var p=h[q];l=p.name;m=q.substr(5);k&&k.addRoom(m,l);if(this._zones.roomPlayers[m])var n=this._zones.roomPlayers[m];else n=new xnm.aio.raumfeld.RoomPlayer(null,null,null,m),this._zones.roomPlayers[m]=n;n.setZonePlayer(k);n.setRoomName(l);p=p.renderer;for(var r in p){e.push(r);n=r.substr(5);var w=p[r],v=b[r];if(v){if(this._zones.dedicatePlayers[n]){var u=this._zones.dedicatePlayers[n];
u.setIP(v.ip);u.setPort(v.port)}else u=new xnm.aio.raumfeld.DedicatePlayer(v.ip,v.port,n),this._zones.dedicatePlayers[n]=u;u.setName(w);u.setRoom(m,l)}}}}for(var t in this._zones.zonePlayers)-1==c.indexOf("uuid:"+t)&&delete this._zones.zonePlayers[t];for(t in this._zones.roomPlayers)-1==d.indexOf("uuid:"+t)&&delete this._zones.roomPlayers[t];for(t in this._zones.dedicatePlayers)-1==e.indexOf("uuid:"+t)&&delete this._zones.dedicatePlayers[t];if(!this._zonePlayer||!this._zones.zonePlayers[this._zonePlayer.getUUID()])for(t in this._zonePlayer=
null,this._zones.zonePlayers)if(this._zones.zonePlayers[t]){this._zonePlayer=this._zones.zonePlayers[t];break}};f.prototype._doGetRequest=function(a,b,c,d){var e=this;a="http://"+a+":"+b+c;this._logger.log("trace","send get to url:"+a);var g=d;$.ajax({url:a,type:"GET",timeout:2E3,dataType:"text",cache:!0,success:function(h){e._logger.log("trace","http request success:"+h);g&&(g(null,h),g=null)},error:function(h,l){h="http request error:"+(h?h.status:"0")+"-"+l;e._logger.log("trace",h);g&&(g(Error(h)),
g=null)}})};f.prototype.toJSON=function(){return{sys:"raumfeld",ip:this.getIP(),port:this.getPort(),uuid:this.getUUID(),type:"master",model:"Raumfeld"}};f.prototype.equalsTo=function(a){return a&&a instanceof f?this.getIP()==a.getIP()&&this.getPort()==a.getPort():!1};return f}();
xnm.aio.raumfeld.ZonePlayer=function(){var f=function(a,b,c){this._renderer=null;this.rooms={};a&&b&&(this._renderer=this._getRenderer(a,b,c))};f.prototype=new xnm.aio.raumfeld.Player;f.prototype.constructor=f;f.prototype.addRoom=function(a,b){this.rooms[a]=b};f.prototype.clearRoom=function(){this.rooms={}};f.prototype.getRooms=function(){return this.rooms};f.prototype.muteRoom=function(a,b){this._setRoomMute(0,a,1,b)};f.prototype.unmuteRoom=function(a,b){this._setRoomMute(0,a,0,b)};f.prototype.toggleMuteRoom=
function(a,b){var c=this;this.isRoomMuted(a,function(d,e){d?b&&b(d):c._setRoomMute(0,a,e?0:1,b)})};f.prototype.isRoomMuted=function(a,b){this._getRoomMute(0,a,function(c,d){c?b&&b(c):b&&b(null,"1"==d.muted)})};f.prototype.getRoomVolume=function(a,b){this._getRoomVolume(0,a,function(c,d){c?b&&b(c):b&&b(null,d.volume)})};f.prototype.setVolumeRoom=function(a,b,c){this._setRoomVolume(0,a,b,c)};f.prototype.volumeUpRoom=function(a,b){var c=this;this.getRoomVolume(a,function(d,e){d?b&&b(d):(d=parseInt(e),
d+=5,100<d&&(d=100),c._setRoomVolume(0,a,d,b))})};f.prototype.volumeDownRoom=function(a,b){var c=this;this.getRoomVolume(a,function(d,e){d?b&&b(d):(d=parseInt(e),d-=5,0>d&&(d=0),c._setRoomVolume(0,a,d,b))})};f.prototype.getPlayInfo=function(a){this._renderer?this._renderer.getPlayInfo(function(b,c){a&&a(b,c)}):a&&a(Error("no renderer"))};f.prototype._getRenderer=function(a,b,c){if(c){var d=require("xnm.aio.raumfeld.js");if(d.discovery&&d.discovery._mediaRenderer&&(d=d.discovery._mediaRenderer[c]))return d}d=
new (require("x.upnp.js").MediaRenderer);d.init(a,b,c,{avTransport:{type:"urn:schemas-upnp-org:service:AVTransport:1",url:"/TransportService/Control"},connectionManager:{type:"urn:schemas-upnp-org:service:ConnectionManager:1",url:"/ConnectionManager/Control"},renderingControl:{type:"urn:schemas-upnp-org:service:RenderingControl:1",url:"/RenderingService/Control"}});return d};f.prototype._getRoomVolume=function(a,b,c){this._renderer._doSOAPRequest(this._renderer.getURL(this._renderer.renderingControl.url),
this._renderer.renderingControl.type,"GetRoomVolume",{InstanceID:a,Room:"uuid:"+b},function(d,e){d?c&&c(d):(d={},e=e.find("CurrentVolume"),0<e.length&&(d.volume=$(e[0]).text()),c&&c(null,d))})};f.prototype._setRoomVolume=function(a,b,c,d){this._renderer._doSOAPRequest(this._renderer.getURL(this._renderer.renderingControl.url),this._renderer.renderingControl.type,"SetRoomVolume",{InstanceID:a,Room:"uuid:"+b,DesiredVolume:c},function(e){d&&d(e)})};f.prototype._getRoomMute=function(a,b,c){this._renderer._doSOAPRequest(this._renderer.getURL(this._renderer.renderingControl.url),
this._renderer.renderingControl.type,"GetRoomMute",{InstanceID:a,Room:"uuid:"+b},function(d,e){d?c&&c(d):(d={},e=e.find("CurrentMute"),0<e.length&&(d.muted=$(e[0]).text()),c&&c(null,d))})};f.prototype._setRoomMute=function(a,b,c,d){this._renderer._doSOAPRequest(this._renderer.getURL(this._renderer.renderingControl.url),this._renderer.renderingControl.type,"SetRoomMute",{InstanceID:a,Room:"uuid:"+b,DesiredMute:c},function(e){d&&d(e)})};f.prototype.equalsTo=function(a){return a&&a instanceof f?this.getIP()==
a.getIP()&&this.getPort()==a.getPort():!1};f.prototype.toJSON=function(){return{sys:"raumfeld",ip:this.getIP(),port:this.getPort(),uuid:this.getUUID(),type:"zone",model:"Raumfeld"}};return f}();
xnm.aio.raumfeld.RoomPlayer=function(){var f=function(a,b,c,d){this._zonePlayer=null;this.uuid=d;this.name=null;a&&b&&(this._zonePlayer=new xnm.aio.raumfeld.ZonePlayer(a,b,c))};f.prototype.setZonePlayer=function(a){this._zonePlayer=a};f.prototype.getUUID=function(){return this.uuid};f.prototype.setRoomName=function(a){this.name=a};f.prototype.getRoomName=function(){return this.name};f.prototype.executeCommandCreator=function(a,b,c){b&&b.value?this._executeCommand(b.value,b.ext,function(d){c&&c(d)}):
c&&c(Error("command value is empty"))};f.prototype.getStatesCreator=function(a,b,c){this._getStates(function(d,e){if(d)c&&c(d);else{d=[];for(var g=0;g<b.length;g++){var h=b[g];if(h&&h.id&&h.status)switch(h.status.value){case "muted":null!=e.muted&&"undefined"!=typeof e.muted&&d.push({id:h.id,status:e.muted});break;case "volume":null!=e.volume&&"undefined"!=typeof e.volume&&d.push({id:h.id,status:e.volume})}}c&&c(null,d)}})};f.prototype._executeCommand=function(a,b,c){if(this._zonePlayer)if(this.uuid)switch(a){case "mute":this._zonePlayer.muteRoom(this.uuid,
function(d){setTimeout(function(){c&&c(d)},500)});break;case "unmute":this._zonePlayer.unmuteRoom(this.uuid,function(d){setTimeout(function(){c&&c(d)},500)});break;case "toggleMute":this._zonePlayer.toggleMuteRoom(this.uuid,function(d){setTimeout(function(){c&&c(d)},500)});break;case "volumeUp":this._zonePlayer.volumeUpRoom(this.uuid,c);break;case "volumeDown":this._zonePlayer.volumeDownRoom(this.uuid,c);break;case "setVolume":if("undefined"==typeof b||null==b){c&&c(Error("volume value invalid"));
break}this._zonePlayer.setVolumeRoom(this.uuid,b,c);break;default:c&&c(Error("unknown command"))}else c&&c(Error("room uuid invalid"));else c&&c(Error("no zone play for this room"))};f.prototype._getStates=function(a){if(this._zonePlayer)if(this.uuid){var b=function(){d--;0==d&&a&&a(null,c)},c={},d=2;this._zonePlayer.isRoomMuted(this.uuid,function(e,g){e||(c.muted=g);b()});this._zonePlayer.getRoomVolume(this.uuid,function(e,g){e||(c.volume=g);b()})}else a&&a(Error("room uuid invalid"));else a&&a(Error("no zone play for this room"))};
f.prototype.equalsTo=function(a){return a&&a instanceof f&&this._zonePlayer&&a._zonePlayer?this._zonePlayer.getIP()==a._zonePlayer.getIP()&&this._zonePlayer.getPort()==a._zonePlayer.getPort():!1};f.prototype.toJSON=function(){return{sys:"raumfeld",ip:this._zonePlayer?this._zonePlayer.getIP():null,port:this._zonePlayer?this._zonePlayer.getPort():null,uuid:this.uuid,type:"room",model:"Raumfeld",zone_uuid:this._zonePlayer?this._zonePlayer.getUUID():null,server_uuid:null,name:this.name}};return f}();
xnm.aio.raumfeld.DedicatePlayer=function(){var f={},a=function(b,c,d){this.name=this.room=this._renderer=null;b&&c&&(this._renderer=this._getRenderer(b,c,d))};a.prototype=new xnm.aio.raumfeld.Player;a.prototype.constructor=a;a.prototype.setName=function(b){this.name=b};a.prototype.setRoom=function(b,c){this.room={};this.room[b]=c};a.prototype.getEqualizer=function(b){var c=this;this._getFilter(0,function(d,e){d?b&&b(d):(f[c._renderer.uuid]||(f[c._renderer.uuid]={}),f[c._renderer.uuid].eqLow=e.eqLow,
f[c._renderer.uuid].eqMid=e.eqMid,f[c._renderer.uuid].eqHigh=e.eqHigh,b&&b(null,e))})};a.prototype.setEqualizer=function(b,c){var d=this;this._setFilter(0,b,function(e){e?c&&c(e):(f[d._renderer.uuid]||(f[d._renderer.uuid]={}),f[d._renderer.uuid].eqLow=b.eqLow,f[d._renderer.uuid].eqMid=b.eqMid,f[d._renderer.uuid].eqHigh=b.eqHigh,c&&c(null))})};a.prototype._executeCommand=function(b,c,d){if(this._renderer)switch(b){case "eqLowTo":case "eqMidTo":case "eqHighTo":if("undefined"==typeof c||null==c){d&&
d(Error("equlizer value invalid"));break}var e=this,g=f[this._renderer.uuid];if(g&&g.eqLow&&g.eqMid&&g.eqHigh){g={eqLow:g.eqLow,eqMid:g.eqMid,eqHigh:g.eqHigh};-1536>c&&(c=-1536);1536<c&&(c=1536);switch(b){case "eqLowTo":g.eqLow=c;break;case "eqMidTo":g.eqMid=c;break;case "eqHighTo":g.eqHigh=c}this.setEqualizer(g,d)}else this.getEqualizer(function(h){h?d&&d(h):e._executeCommand(b,c,d)});break;default:xnm.aio.raumfeld.Player.prototype._executeCommand.call(this,b,c,d)}else d&&d(Error("renderer not initialized"))};
a.prototype._getStates=function(b){if(this._renderer){var c=function(){e--;0==e&&b&&b(null,d)},d={},e=3;this._renderer.isMuted(function(g,h){g||(d.muted=h);c()});this._renderer.getVolume(function(g,h){g||(d.volume=h);c()});this.getEqualizer(function(g,h){!g&&h&&(d.eq=h);c()})}else b&&b(Error("renderer not initialized"))};a.prototype._getRenderer=function(b,c,d){if(d){var e=require("xnm.aio.raumfeld.js");if(e.discovery&&e.discovery._mediaRenderer&&(e=e.discovery._mediaRenderer[d]))return e}e=new (require("x.upnp.js").MediaRenderer);
e.init(b,c,d,{avTransport:{type:"urn:schemas-upnp-org:service:AVTransport:1",url:"/AVTransport/ctrl"},connectionManager:{type:"urn:schemas-upnp-org:service:ConnectionManager:1",url:"/ConnectionManager/ctrl"},renderingControl:{type:"urn:schemas-upnp-org:service:RenderingControl:1",url:"/RenderingControl/ctrl"}});return e};a.prototype._getFilter=function(b,c){this._renderer._doSOAPRequest(this._renderer.getURL(this._renderer.renderingControl.url),this._renderer.renderingControl.type,"GetFilter",{InstanceID:b},
function(d,e){if(d)c&&c(d);else{d={};var g=e.find("LowDB");0<g.length&&(d.eqLow=$(g[0]).text());g=e.find("MidDB");0<g.length&&(d.eqMid=$(g[0]).text());g=e.find("HighDB");0<g.length&&(d.eqHigh=$(g[0]).text());c&&c(null,d)}})};a.prototype._setFilter=function(b,c,d){this._renderer._doSOAPRequest(this._renderer.getURL(this._renderer.renderingControl.url),this._renderer.renderingControl.type,"SetFilter",{InstanceID:b,LowDB:c.eqLow,MidDB:c.eqMid,HighDB:c.eqHigh},function(e){d&&d(e)})};a.prototype.equalsTo=
function(b){return b&&b instanceof a?this.getIP()==b.getIP()&&this.getPort()==b.getPort():!1};a.prototype.toJSON=function(){return{sys:"raumfeld",ip:this.getIP(),port:this.getPort(),uuid:this.getUUID(),type:"player",model:this._renderer?this._renderer.modelName:null,server_uuid:null,name:this.name,room:this.room}};return a}();
xnm.aio.raumfeld.Discovery=function(){var f=function(){this._logger="undefined"!=typeof require&&require?require("x.logger.js").getLogger("xnm.aio.raumfeld.Discovery"):{log:{}};this._masterPlayer=this._upnpCB=null;this._mediaServer={};this._mediaRenderer={};this._searchRaumfeldCB=[];this._autoSearchTimeout=null;this.searchRaumfeld(null)};f.prototype.getPlayer=function(a){if(!a||!a.type||!a.uuid)return null;if("master"==a.type){if(!this._masterPlayer){if(!a.ip||!a.port)return null;this._masterPlayer=
new xnm.aio.raumfeld.MasterPlayer(a.ip,a.port,a.uuid);this._masterPlayer._isDummy=!0}a=this._masterPlayer}else if("room"==a.type)a=this._masterPlayer.getRoomPlayer(a);else if("player"==a.type)a=this._masterPlayer.getDedicatePlayer(a);else return null;a&&!a._isDummy||this.searchRaumfeld(null);return a};f.prototype.getDiscoveredPlayer=function(a,b){if(!a||!b)return null;if("master"==a)a=this._masterPlayer;else if("room"==a)a=this._masterPlayer.getDiscoveredRoomPlayer(b);else if("player"==a)a=this._masterPlayer.getDiscoveredDedicatePlayer(b);
else return null;a&&!a._isDummy||this.searchRaumfeld(null);return a};f.prototype.getBufferedMediaServers=function(){var a=[],b;for(b in this._mediaServer)if(this._mediaServer.hasOwnProperty(b)){var c=this._mediaServer[b];c.manufacturer&&-1!=c.manufacturer.indexOf("Raumfeld")&&(c._raumfeldMaster=!0);a.push(c)}return a};f.prototype.getBufferedPlayers=function(){if(!this._masterPlayer)return[];var a=null,b;for(b in this._mediaServer)if(this._mediaServer.hasOwnProperty(b)){var c=this._mediaServer[b];
if(c&&c.ip==this._masterPlayer.getIP()){a=c.uuid;break}}if(!a)return[];var d=[];d.push(this._masterPlayer.toJSON());(b=this._masterPlayer.getRoomPlayers())&&b.forEach(function(g){g&&(g=g.toJSON(),g.server_uuid=a,d.push(g))});var e=this;(b=this._masterPlayer.getDedicatePlayers())&&b.forEach(function(g){g=g.toJSON();var h=g.uuid;g.server_uuid=a;if(h=e._mediaRenderer[h])g.model=h.modelName;d.push(g)});return d};f.prototype.searchRaumfeld=function(a){var b=this._searchRaumfeldCB.length;a&&-1==this._searchRaumfeldCB.indexOf(a)&&
this._searchRaumfeldCB.push(a);if(0==b){this._autoSearchTimeout&&(clearTimeout(this._autoSearchTimeout),this._autoSearchTimeout=null);this._search();var c=this;setTimeout(function(){c._autoSearchTimeout=setTimeout(function(){c._logger.log("trace","auto search timeout, search again");c.searchRaumfeld(null)},3E4);var d=c._searchRaumfeldCB;c._searchRaumfeldCB=[];d.forEach(function(e){e&&e()})},5E3)}};f.prototype._search=function(){if(!this._upnpCB){var a=this;this._upnpCB=function(c){a._findUpnpDevice(c)}}this._mediaServer=
{};this._mediaRenderer={};var b=require("x.upnp.js").getDiscoveryService();b.addCallback("upnp:rootdevice",this._upnpCB);b.discoverTarget("upnp:rootdevice")};f.prototype._findUpnpDevice=function(a){if(a){var b=a.uuid;switch(a.deviceType){case "urn:schemas-raumfeld-com:device:ConfigDevice:1":this._logger.log("trace","find raumfeld master");this._masterPlayer||(this._masterPlayer=new xnm.aio.raumfeld.MasterPlayer(a.ip,0,a.uuid));this._masterPlayer._isDummy=!1;this._masterPlayer.ip=a.ip;this._masterPlayer.getInfos(null);
break;case "urn:schemas-upnp-org:device:MediaServer:1":this._logger.log("trace","find media server:"+a.name+" @"+a.ip);this._mediaServer[b]=a;break;case "urn:schemas-upnp-org:device:MediaRenderer:1":this._logger.log("trace","find media renderer:"+a.name+" @"+a.ip),this._mediaRenderer[b]=a}}};return f}();
xnm.aio.raumfeld.DM=function(){var f={master:{command:[{type:"enum",name:"play",ref:{value:"play"}},{type:"enum",name:"pause",ref:{value:"pause"}},{type:"enum",name:"stop",ref:{value:"stop"}},{type:"enum",name:"previous",ref:{value:"previous"}},{type:"enum",name:"next",ref:{value:"next"}},{type:"enum",name:"mute",ref:{value:"mute"}},{type:"enum",name:"unmute",ref:{value:"unmute"}},{type:"enum",name:"toggle mute",ref:{value:"toggleMute"}},{type:"enum",name:"volume up",ref:{value:"volumeUp"}},{type:"enum",
name:"volume down",ref:{value:"volumeDown"}},{type:"int",name:"set volume",ref:{value:"setVolume",ext:"%d",extMeta:"0-100"}},{type:"int",name:"seek to (seconds)",ref:{value:"seekTo",ext:"%d"}},{type:"enum",name:"toggle shuffle",ref:{value:"shuffleToggle"}},{type:"enum",name:"switch repeat",ref:{value:"repeatSwitch"}}],status:[{type:"enum",name:"muted",ref:{value:"muted",options:["true","false"]}},{type:"int",name:"volume",ref:{value:"volume",extMeta:"0-100"}},{type:"string",name:"play state",ref:{value:"playState",
options:"STOPPED PLAYING TRANSITIONING PAUSED_PLAYBACK PAUSED_RECORDING RECORDING NO_MEDIA_PRESENT".split(" ")}},{type:"string",name:"track duration",ref:{value:"duration"}},{type:"int",name:"track duration (seconds)",ref:{value:"durationS"}},{type:"string",name:"track position",ref:{value:"position"}},{type:"int",name:"track position (seconds)",ref:{value:"positionS"}},{type:"string",name:"artist",ref:{value:"artist"}},{type:"string",name:"title",ref:{value:"title"}},{type:"string",name:"album",
ref:{value:"album"}},{type:"enum",name:"shuffle state",ref:{value:"shuffle",options:["on","off"]}},{type:"enum",name:"repeat state",ref:{value:"repeat",options:["off","one","all"]}}]},room:{command:[{type:"enum",name:"mute",ref:{value:"mute"}},{type:"enum",name:"unmute",ref:{value:"unmute"}},{type:"enum",name:"toggle mute",ref:{value:"toggleMute"}},{type:"enum",name:"volume up",ref:{value:"volumeUp"}},{type:"enum",name:"volume down",ref:{value:"volumeDown"}},{type:"int",name:"set volume",ref:{value:"setVolume",
ext:"%d",extMeta:"0-100"}}],status:[{type:"enum",name:"muted",ref:{value:"muted",options:["true","false"]}},{type:"int",name:"volume",ref:{value:"volume",extMeta:"0-100"}}]},player:{command:[{type:"enum",name:"mute",ref:{value:"mute"}},{type:"enum",name:"unmute",ref:{value:"unmute"}},{type:"enum",name:"toggle mute",ref:{value:"toggleMute"}},{type:"enum",name:"volume up",ref:{value:"volumeUp"}},{type:"enum",name:"volume down",ref:{value:"volumeDown"}},{type:"int",name:"set volume",ref:{value:"setVolume",
ext:"%d",extMeta:"0-100"}},{type:"int",name:"set equalizer low (db)",ref:{value:"eqLowTo",ext:"%d",extMeta:"-1536-1536"}},{type:"int",name:"set equalizer middle (db)",ref:{value:"eqMidTo",ext:"%d",extMeta:"-1536-1536"}},{type:"int",name:"set equalizer high (db)",ref:{value:"eqHighTo",ext:"%d",extMeta:"-1536-1536"}}],status:[{type:"enum",name:"muted",ref:{value:"muted",options:["true","false"]}},{type:"int",name:"volume",ref:{value:"volume",extMeta:"0-100"}},{type:"int",name:"equalizer low (db)",ref:{value:"eqLow"}},
{type:"int",name:"equalizer middle (db)",ref:{value:"eqMid"}},{type:"int",name:"equalizer high (db)",ref:{value:"eqHigh"}}]}},a=function(b,c){this.code=b;this.message=c;this.stack=Error().stack};a.prototype=Error();a.prototype.name="RaumfeldDMError";a.prototype.code=0;a.ERROR_CODE={DEFAULT:0,INDEX_EXISTS:1,ID_EXISTS:2,INVALID:3,UNKNOW:4,NOT_FOUND:5,IP_EXISTS:6};return{SYS:"raumfeld",getIPDeviceType:function(){return[{sys:this.SYS,name:"Raumfeld"}]},createDevice:function(b,c,d){c=a.ERROR_CODE;b?b.type?
b.ip?b.port?d(null,b):d(new a(c.INVALID,"port is invalid")):d(new a(c.INVALID,"ip is invalid")):d(new a(c.INVALID,"type is invalid")):d(new a(c.INVALID,"info is invalid"))},updateDevice:function(b,c,d){c=a.ERROR_CODE;b?b.type?b.ip?b.port?d(null,b):d(new a(c.INVALID,"port is invalid")):d(new a(c.INVALID,"ip is invalid")):d(new a(c.INVALID,"type is invalid")):d(new a(c.INVALID,"info is invalid"))},deleteDevice:function(b,c,d){d()},applyUIFilter:function(b,c,d){var e=function(k,q){if("*"==k)return!0;
for(var p=!1,n=0;n<k.length;n++)if(k[n]==q){p=!0;break}return p},g=function(k,q,p){var n=[];switch(p.catagory){case "command":k.command&&k.command.forEach(function(r){e(p.elems,r.type)&&(r=JSON.parse(JSON.stringify(r)),n.push(r))});break;case "status":k.status&&k.status.forEach(function(r){e(p.elems,r.type)&&(r=JSON.parse(JSON.stringify(r)),n.push(r))})}return n},h=function(k,q){var p=[],n=xnm.aio.raumfeld.DM.getCommandStatusMap(k,d);n&&(k=g(n,k,q),p=p.concat(k));return p};if(!b.sys)return null;var l=
JSON.parse(JSON.stringify(b)),m=null;switch(c.catagory){case "command":m=h(b,c);l.command=m;break;case "status":m=h(b,c);l.status=m;break;default:return null}return m&&0!=m.length?l:null},getCommandStatusMap:function(b,c){return b&&b.type?f[b.type]:null},applySmartWidgetFilter:function(b,c,d,e,g){d={"%next%":{value:"next"},"%pause%":{value:"pause"},"%play%":{value:"play"},"%previous%":{value:"previous"},"%stop%":{value:"stop"},"%toggleMute%":{value:"toggleMute"},"%volume%":{value:"setVolume",ext:"%d",
extMeta:"0-100"}};var h={"%mutedState%":{value:"muted",options:["true","false"]},"%volumeState%":{value:"volume",extMeta:"0-100"}};"master"===c.type?(d["%seekTo%"]={value:"seekTo",ext:"%d"},d["%shuffleToggle%"]={value:"shuffleToggle"},h["%durationState%"]={value:"durationS"},h["%playState%"]={value:"playState",options:"STOPPED PLAYING TRANSITIONING PAUSED_PLAYBACK PAUSED_RECORDING RECORDING NO_MEDIA_PRESENT".split(" ")},h["%positionState%"]={value:"positionS"},h["%shuffleState%"]={value:"shuffle",
options:["on","off"]}):"player"===c.type?(d["%balance%"]={value:"eqMidTo",ext:"%d",extMeta:"-1536-1536"},d["%bass%"]={value:"eqLowTo",ext:"%d",extMeta:"-1536-1536"},d["%treble%"]={value:"eqHighTo",ext:"%d",extMeta:"-1536-1536"},h["%balanceState%"]={value:"eqMid"},h["%bassState%"]={value:"eqLow"},h["%trebleState%"]={value:"eqHigh"}):"room"===c.type&&(delete d["%next%"],delete d["%pause%"],delete d["%play%"],delete d["%previous%"],delete d["%stop%"]);return b._injectToSmartWidgetTemplate(e,["media"],
g,d,h,null)}}}();
xnm.aio.raumfeld.Handler=function(){var f=function(){this.discovery=new xnm.aio.raumfeld.Discovery};f.prototype.devicemanager=xnm.aio.raumfeld.DM;f.prototype.registModule=function(a){a.register(xnm.aio.raumfeld.DM.SYS,"raumfeld")};f.prototype.resolveDevice=function(a){return a?this.discovery.getPlayer(a):null};f.prototype.getDeviceCommands=function(a,b){a=(a=this.devicemanager.applyUIFilter(a,{catagory:"command",elems:"*"}))?a.command:[];b&&b(null,a)};f.prototype.getDeviceStatus=function(a,b){a=(a=
this.devicemanager.applyUIFilter(a,{catagory:"status",elems:"*"}))?a.status:[];b&&b(null,a)};f.prototype.doCommand=function(a,b,c){var d=this.resolveDevice(a);d?d.executeCommandCreator(a,b,function(e){c&&c(e)}):c&&c(Error("device json format invalid"))};f.prototype.doStatus=function(a,b,c,d){var e=this.resolveDevice(b);e?e.getStatesCreator(null,[{id:a,device:b,status:c}],function(g,h){g?d&&d(g):d&&d(null,h[0])}):d&&d(Error("device json format invalid"))};f.prototype.discover=function(a){var b=this;
this.discovery.searchRaumfeld(function(){a&&a(null,b.discovery.getBufferedPlayers())})};f.prototype.getPlayer=function(a,b){if(a&&a.uuid&&a.type){var c=this.discovery.getDiscoveredPlayer(a.type,a.uuid);if(c)b&&b(null,c);else{var d=this;this.discovery.searchRaumfeld(function(){c=d.discovery.getDiscoveredPlayer(a.type,a.uuid);b&&b(null,c)})}}else b&&b(Error("device json invalid"))};f.prototype.getMediaServer=function(a){var b=this.discovery.getBufferedMediaServers();if(0==b.length){var c=this;this.discovery.searchRaumfeld(function(){a&&
a(null,c.discovery.getBufferedMediaServers())})}else a&&a(null,b)};return f}();"undefined"!=typeof exports&&"undefined"!=typeof module&&module.exports&&(exports=module.exports=new xnm.aio.raumfeld.Handler);
