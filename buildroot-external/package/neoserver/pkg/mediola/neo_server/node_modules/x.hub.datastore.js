var x=x||{};x.hub=x.hub||{};x.hub.datastore=x.hub.datastore||{};
x.hub.datastore.DataStore=function(){var d=function(a){this._file=a};d.DB_FILE="xhub.db";d.prototype.init=function(a,b){var c=require("fs-extra"),e=require("path");this._file||(this._file=e.resolve(a.getUserRootDataPath(),"xhub.db"));var f=this;c.ensureFile(this._file,function(g){g?b&&b(g):f._initDB(b)})};d.prototype._initDB=function(a){var b=new (require("sqlite3").Database)(this._file,function(c){c?a&&a(c):b.serialize(function(){b.run("CREATE TABLE IF NOT EXISTS windowstate (id integer primary key autoincrement, window text, state text, time datetime default current_timestamp)",function(e){b.close();
a&&a(e)})})})};d.prototype.openDB=function(a){var b=new (require("sqlite3").Database)(this._file,function(c){a&&a(c,b)})};d.prototype._dumpTable=function(a){this.openDB(function(b,c){!b&&c&&c.each("SELECT * FROM "+a,function(e,f){XC.debugf(f);c.close()})})};return d}();x.hub.datastore.Handler=function(){this.dataStore=new x.hub.datastore.DataStore};x.hub.datastore.Handler.prototype.DataStore=x.hub.datastore.DataStore;
x.hub.datastore.Handler.prototype.init=function(d,a){this.dataStore.init(d,function(b){a&&a({error:b})})};module.exports=new x.hub.datastore.Handler;
