var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,b){var c=$jscomp.propertyToPolyfillSymbol[b];if(null==c)return a[b];c=a[c];return void 0!==c?c:a[b]};
$jscomp.polyfill=function(a,b,c,d){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,c,d):$jscomp.polyfillUnisolated(a,b,c,d))};$jscomp.polyfillUnisolated=function(a,b,c,d){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))return;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})};
$jscomp.polyfillIsolated=function(a,b,c,d){var e=a.split(".");a=1===e.length;d=e[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<e.length-1;f++){var g=e[f];if(!(g in d))return;d=d[g]}e=e[e.length-1];c=$jscomp.IS_SYMBOL_NATIVE&&"es6"===c?d[e]:null;b=b(c);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:b}):b!==c&&(void 0===$jscomp.propertyToPolyfillSymbol[e]&&(c=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+c+"$"+e),$jscomp.defineProperty(d,$jscomp.propertyToPolyfillSymbol[e],{configurable:!0,writable:!0,value:b})))};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(a){if(a)return a;var b=function(f,g){this.$jscomp$symbol$id_=f;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:g})};b.prototype.toString=function(){return this.$jscomp$symbol$id_};var c="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",d=0,e=function(f){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new b(c+(f||"")+"_"+d++,f)};return e},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var d=$jscomp.global[b[c]];"function"===typeof d&&"function"!=typeof d.prototype[a]&&$jscomp.defineProperty(d.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return a},"es6",
"es3");$jscomp.iteratorPrototype=function(a){a={next:a};a[Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,b){a instanceof String&&(a+="");var c=0,d=!1,e={next:function(){if(!d&&c<a.length){var f=c++;return{value:b(f,a[f]),done:!1}}d=!0;return{done:!0,value:void 0}}};e[Symbol.iterator]=function(){return e};return e};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6","es3");
var m=m||{};m.aio=m.aio||{};m.aio.templatemanager=m.aio.templatemanager||{};m.aio.templatemanager.OPTIONS={host:"localhost",port:8080,path:"",headers:{"Content-Type":'application/json; charset="UTF-8"',"User-Agent":"mediola",Connection:"close"}};m.aio.templatemanager.SysTemplateUploader=function(a,b,c){this.authHeader=a;this.skinName=b;this.templateName=c};
m.aio.templatemanager.SysTemplateUploader.prototype={upload:function(a,b){var c=this;require("m.aio.configmanager.js").trace(a,function(d,e){d?b&&b(d):c._processPage(e,b)})},_processPage:function(a,b){var c=a.getChild("pagecontent");c=this._removeDevice(JSON.parse(JSON.stringify(c.content)));var d="/creatorneo/template/uploadSysTemplate?";d+="skin="+encodeURI(this.skinName);d+="&name="+encodeURI(this.templateName);var e=this;this._doPostRequest(d,null,JSON.stringify(c),function(f,g){if(f)b&&b(f);
else if(g){try{g=JSON.parse(g)}catch(l){b&&b("upload system template response json invalid");return}if(g.id){f=a.getFolderPath();var h=f.substr(0,f.length-2)+".png",k=require("fs");k.exists(h,function(l){l?k.readFile(h,function(n,p){n?b&&b():(d="/creatorneo/template/uploadSysTemplateThumb?",d+="id="+g.id,e._doPostRequest(d,{"Content-Type":"application/octet-stream"},p,function(q){b&&b(q)}))}):b&&b()})}else b&&b("upload system template response has not template id")}else b&&b("upload system template response invalid")})},
_removeDevice:function(a){delete a.action;a.labels&&a.labels.forEach(function(b){delete b.action;delete b.status});a.infos&&a.infos.forEach(function(b){delete b.action;delete b.status});a.buttons&&a.buttons.forEach(function(b){delete b.action;delete b.status});a.sliders&&a.sliders.forEach(function(b){delete b.action;delete b.status});a.colorchoosers&&a.colorchoosers.forEach(function(b){delete b.action;delete b.status});a.analogmeters&&a.analogmeters.forEach(function(b){delete b.action;delete b.status});
a.cams&&a.cams.forEach(function(b){b.cam&&delete b.cam.device});a.webpages&&a.webpages.forEach(function(b){b.webpage&&delete b.webpage.device});return a},_doPostRequest:function(a,b,c,d){var e=d,f=JSON.parse(JSON.stringify(m.aio.templatemanager.OPTIONS));f.path+=a;f.method="POST";this.authHeader&&(f.auth=this.authHeader);b&&Object.keys(b).forEach(function(h){f.headers[h]=b[h]});var g="";a=require("http").request(f,function(h){h.setEncoding("utf8");h.on("data",function(k){g+=k});h.on("end",function(){200==
h.statusCode?e&&e(null,g):e&&e(Error("http error with status code:"+h.statusCode),g);e=null})});a.on("error",function(h){e&&(e(h),e=null)});a.write(c);a.end()}};m.aio.templatemanager.Handler=function(){this._configmanager=null};
m.aio.templatemanager.Handler.prototype={init:function(a,b,c,d){this._configmanager=a;b&&(m.aio.templatemanager.OPTIONS.host=b,m.aio.templatemanager.OPTIONS.host=b,m.aio.templatemanager.OPTIONS.host=b);c&&0<c&&(m.aio.templatemanager.OPTIONS.port=c,m.aio.templatemanager.OPTIONS.port=c,m.aio.templatemanager.OPTIONS.port=c);process&&"local"==process.env.CLOUD&&(m.aio.templatemanager.OPTIONS.path="/webservice",m.aio.templatemanager.OPTIONS.path="/webservice",m.aio.templatemanager.OPTIONS.path="/webservice");
d&&d()},uploadSystemTemplate:function(a,b,c,d,e){a&&b&&c&&d?(new m.aio.templatemanager.SysTemplateUploader(a,b,c)).upload(d,e):e&&e(Error("invalid parameter"))},submitUserTemplate:function(a,b,c){a&&a.tenantIdx&&a.remoteIdx&&a.remotePageIdxes||c&&c(Error("options invalid"))}};"undefined"!=typeof module&&null!=module&&(module.exports=new m.aio.templatemanager.Handler);
