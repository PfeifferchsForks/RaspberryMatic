var x=x||{};x.videoplayer=x.videoplayer||{};
x.videoplayer.Player=function(){var e=function(a){this._options=a;this._listeners={}};e.prototype.on=function(a,b){a&&b&&(this._listeners[a]||(this._listeners[a]=[]),-1==this._listeners[a].indexOf(b)&&this._listeners[a].push(b))};e.prototype.off=function(a,b){a&&b&&this._listeners[a]&&(b=this._listeners[a].indexOf(b),-1!=b&&this._listeners[a].splice(b,1))};e.prototype.init=function(a){throw Error("func init not implemented");};e.prototype.playHLS=function(a){};e.prototype.playFLV=function(a){};e.prototype._emitEvent=
function(a,b){if(a){var c=this._listeners[a];if(c&&0<c.length)for(var f=0;f<c.length;f++){var g=c[f];try{g(b)}catch(h){this._logger.log("trace","call "+a+" listener failed, error:"+h.message)}}}};var d=function(a){e.call(this,a);this._logger=require("x.logger.js").getLogger("x.videoplayer.MobilePlayer");this._playerID=null;var b=this;this._nativeListener=function(c){c?c.error?b._emitEvent("error",Error(c.error)):c.close?b._emitEvent("close"):c.start?b._emitEvent("start"):c.end?b._emitEvent("end"):
c.replay?b._emitEvent("replay"):c.init&&(c.init.error?b._emitEvent("init",Error(c.init.error)):(b._playerID=c.init.playerID,b._emitEvent("init"))):b._emitEvent("error",Error("native bridge error"))}};d.prototype=new e;d.prototype.constructor=d;d.prototype.init=function(a){if(a)this.on("init",a);XC.callHost("videoplayer","createPlayer",this._options?this._options:{},this._nativeListener)};d.prototype.playHLS=function(a,b){XC.callHost("videoplayer","playHLS",{playerID:this._playerID,url:a,duration:b})};
d.prototype.playMP4=function(a,b,c){XC.callHost("videoplayer","playMP4",{playerID:this._playerID,url:a,duration:b,options:c})};d.prototype.playRTSP=function(a,b){XC.callHost("videoplayer","playRTSP",{playerID:this._playerID,url:a,transport:b})};d.prototype.playMultiHLS=function(a){XC.callHost("videoplayer","playMultiHLS",{playerID:this._playerID,urls:a})};d.prototype.playFLV=function(a,b){XC.callHost("videoplayer","playFLV",{playerID:this._playerID,url:a,duration:b})};d.prototype.close=function(){XC.callHost("videoplayer",
"closePlayer",{playerID:this._playerID})};e.iOSPlayer=d;e.AndroidPlayer=d;return e}();
x.videoplayer.Handler=function(){var e=function(){};e.prototype.createVideoPlayer=function(d,a){var b=null,c=null;"undefined"!=typeof window&&null!=window&&window.XCHost||(b="node-webkit");"undefined"!=typeof window&&null!=window&&window.XCHost&&window.XCHost.getType&&(b=window.XCHost.getType());c="Android"==b?new x.videoplayer.Player.AndroidPlayer(d):"node-webkit"==b||"undefined"!=typeof process&&null!=process&&"node"==process.title?new x.videoplayer.Player.NWPlayer(d):new x.videoplayer.Player.iOSPlayer(d);
c.init(function(f){a&&a(f,c)})};return e}();"undefined"!=typeof module&&null!=module&&(module.exports=new x.videoplayer.Handler);
